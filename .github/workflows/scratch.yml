name: Scratch

on:
  workflow_dispatch:
    inputs:
      working_dir: { default: "." }

      # NOTE: Please keep these in sync with ../../.terra*-version files.
      tf_version: { default: "1.6.4" }
      tg_version: { default: "0.53.5" }

  schedule:
    - cron: "0 0 * * *"

  pull_request:
    types:
      - opened
      - synchronize
      - reopened
      - labeled
      - closed

env:
  working_dir: "ENV:./terraform/env"
  tf_version: "ENV:1.6.4"
  tg_version: "ENV:0.53.5"

jobs:
  scratch:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write
    steps:
      - name: show event
        run: |
          : <<'EOF'
            ${{toJSON(github.event)}}
          EOF

      - name: show context
        run: |
          jq . <<< '{
            "github": ${{ toJSON(github) }}
            "env": ${{ toJSON(env) }}
            "vars": ${{ toJSON(vars) }}
            "job": ${{ toJSON(job) }}
            "steps": ${{ toJSON(steps) }}
            "runner": ${{ toJSON(runner) }}
            "secrets": ${{ toJSON(secrets) }}
            "strategy": ${{ toJSON(strategy) }}
            "matrix": ${{ toJSON(matrix) }}
            "needs": ${{ toJSON(needs) }}
            "inputs": ${{ toJSON(inputs) }}
          }'
